\documentclass[a4paper,twocolumn]{extarticle}

\usepackage{lmodern}
\usepackage{anyfontsize}
%\renewcommand{\normalsize}{\fontsize{7pt}{8.4pt}\selectfont}
\usepackage{setspace}
\usepackage{pscyr}
\usepackage[utf8]{inputenc}
\usepackage[english, russian]{babel}

\usepackage{extsizes}
\usepackage[a4paper,top=0.5cm,bottom=1.0cm,left=1.0cm,right=0.5cm,nomarginpar,foot=0.3cm,includehead]{geometry}
\usepackage{lastpage}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{fancyhdr}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{tikz}

\hypersetup{
    colorlinks=true,
    linkcolor=black,
    filecolor=magenta,
    urlcolor=blue,
}

\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{1,1,1}

\lstdefinestyle{codestyle}{
    language=C++,
    backgroundcolor=\color{backcolour},
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily,
    breakatwhitespace=false,
    breaklines=true,
    captionpos=b,
    keepspaces=true,
    numbersep=5pt,
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    tabsize=2
}

\lstset{
    style=codestyle,
    extendedchars=\true,
}
\setlength{\columnseprule}{0.4pt}
\setlength{\columnsep}{30pt}

\begin{document}
    \pagestyle{fancy}
    \fancyhead[LO]{St. Petersburg State University (Ananev, Kuznetsov, Zgonnik)}
    \fancyhead[R]{Page \thepage~of~\pageref{LastPage}}

{\fontsize{7.8pt}{8.5pt}\selectfont
    \tableofcontents
    \newpage
    \lstinputlisting{starting/starting.cpp}
    \lstinputlisting{rng/rng.cpp}
    \section{Теория чисел}
    \lstinputlisting{Number Theory/fastpow/fastpow.cpp}
    \lstinputlisting{Number Theory/Linear Sieve/Linear Sieve.cpp}
    \lstinputlisting{Number Theory/factorization sqrt/factorization sqrt.cpp}
    \lstinputlisting{Number Theory/Divisors/All divisors.cpp}
}
    \newpage
\end{document}
